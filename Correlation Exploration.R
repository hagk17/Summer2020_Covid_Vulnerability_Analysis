
library(MASS)
library(caret)
library(leaps)
library(xlsx)
library(magrittr)
library(factoextra)
library(ggplot2)
library(esquisse)
library(tidyverse)
library(corrplot)


census_data <- read.xlsx("Data/clean_0909_data", sheetIndex = 6)
census_data %<>% dplyr::select(-NA.)



###### -------------Correlation Plots ------------------ ######

cor_census <- census_data %>% dplyr::select(-Town, -n_asthma, -p_asthma, -n_occUnitsZero,
                                     -p_occUnitsZero)

alpha_census_data <- cor_census[ , order(names(cor_census))]
count_columns <- c(1:27,55,56)
prop_columns <- c(28:55)

cor_count_data <- alpha_census_data[ ,count_columns]
cor_por_data <- alpha_census_data[ ,prop_columns]

### correlation matrices 
count_cor_matrix <- round(cor(cor_count_data, use="complete.obs", method="pearson"),4)
prop_cor_matrix <- round(cor(cor_por_data, use="complete.obs", method="pearson"), 4)


corrplot(count_cor_matrix, method="circle")
corrplot(count_cor_matrix, method="color", order="hclust",  type = "upper")
corrplot(count_cor_matrix, method="number", type = "upper")

corrplot(count_cor_matrix, method = "circle",  order="hclust",  type = "lower",
         tl.col="black", tl.srt=20)
corrplot(prop_cor_matrix, method = "circle",  order="hclust",  type = "lower",
         tl.col="black", tl.srt=20)


